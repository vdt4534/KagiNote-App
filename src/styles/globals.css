/* globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties for Platform Detection */
:root {
  --platform: 'web';
  --titlebar-height: 44px;
}

.platform-macos {
  --platform: 'macos';
  --titlebar-height: 44px;
}

.platform-windows {
  --platform: 'windows';
  --titlebar-height: 32px;
}

.platform-linux {
  --platform: 'linux';
  --titlebar-height: 32px;
}

/* Base styles */
@layer base {
  html {
    font-family: theme('fontFamily.sans');
    font-size: 16px;
    line-height: 1.5;
  }
  
  body {
    @apply bg-neutral-50 text-neutral-900 antialiased;
    margin: 0;
    padding: 0;
    overflow: hidden; /* Desktop app - no scroll */
  }
  
  /* CJK character support */
  .text-cjk {
    font-family: theme('fontFamily.cjk');
    line-height: 1.75;
  }
  
  /* Accessibility improvements */
  .focus-ring {
    @apply ring-2 ring-primary-500 ring-offset-2 outline-none;
  }
  
  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
  
  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .focus-ring {
      outline: 3px solid;
      outline-color: Highlight;
    }
  }
}

/* Component base styles */
@layer components {
  /* Platform-specific styles */
  .titlebar-drag {
    -webkit-app-region: drag;
    user-select: none;
  }
  
  .titlebar-no-drag {
    -webkit-app-region: no-drag;
  }
  
  /* macOS-specific styles */
  .macos-blur {
    background: rgba(255, 255, 255, 0.72);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }
  
  .macos-dark-blur {
    background: rgba(30, 30, 30, 0.72);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }
  
  /* Windows-specific styles */
  .windows-mica {
    background: rgba(255, 255, 255, 0.78);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
  }
  
  .windows-dark-mica {
    background: rgba(30, 30, 30, 0.78);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
  }
  
  /* Button components */
  .btn {
    @apply px-4 py-3 rounded-md font-medium transition-all duration-200 focus:focus-ring;
    @apply flex items-center justify-center gap-2;
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-primary {
    @apply btn bg-primary-600 text-white hover:bg-primary-700 active:bg-primary-800;
    @apply shadow-sm hover:shadow;
  }
  
  .btn-secondary {
    @apply btn bg-transparent text-primary-600 border border-primary-600;
    @apply hover:bg-primary-50 active:bg-primary-100;
  }
  
  .btn-ghost {
    @apply btn bg-transparent text-neutral-600 hover:bg-neutral-100 active:bg-neutral-200;
  }
  
  .btn-danger {
    @apply btn bg-error-600 text-white hover:bg-error-700 active:bg-error-800;
    @apply shadow-sm hover:shadow;
  }
  
  .btn-sm {
    @apply px-3 py-2 text-sm;
  }
  
  .btn-lg {
    @apply px-6 py-4 text-lg;
  }
  
  /* Input components */
  .input {
    @apply w-full px-4 py-3 border border-neutral-300 rounded-md bg-white text-neutral-900;
    @apply placeholder-neutral-400 transition-colors;
    @apply focus:border-primary-500 focus:ring-2 focus:ring-primary-100 focus:outline-none;
    @apply disabled:bg-neutral-50 disabled:text-neutral-500 disabled:cursor-not-allowed;
  }
  
  .input-sm {
    @apply px-3 py-2 text-sm;
  }
  
  .input-lg {
    @apply px-5 py-4 text-lg;
  }
  
  /* Card components */
  .card {
    @apply bg-white border border-neutral-200 rounded-lg shadow-sm;
  }
  
  .card-header {
    @apply p-6 border-b border-neutral-200;
  }
  
  .card-body {
    @apply p-6;
  }
  
  .card-footer {
    @apply p-6 border-t border-neutral-200 bg-neutral-50;
  }
  
  /* Badge components */
  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }
  
  .badge-primary {
    @apply badge bg-primary-100 text-primary-800;
  }
  
  .badge-secondary {
    @apply badge bg-secondary-100 text-secondary-800;
  }
  
  .badge-warning {
    @apply badge bg-warning-100 text-warning-800;
  }
  
  .badge-error {
    @apply badge bg-error-100 text-error-800;
  }
  
  .badge-neutral {
    @apply badge bg-neutral-100 text-neutral-800;
  }
  
  /* Modal components */
  .modal-overlay {
    @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-modal;
    @apply animate-fade-in;
  }
  
  .modal-content {
    @apply bg-white rounded-xl shadow-modal max-w-lg w-full mx-4;
    @apply animate-slide-in;
  }
  
  /* Audio visualization */
  .audio-bar {
    @apply transition-all duration-75 ease-out;
    transform-origin: bottom;
  }
  
  .audio-bar.recording {
    @apply bg-secondary-500;
  }
  
  .audio-bar.playing {
    @apply bg-primary-500;
  }
  
  .audio-bar.idle {
    @apply bg-neutral-300;
  }
  
  /* Scrollbar styles */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: theme('colors.neutral.400') transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: theme('colors.neutral.400');
    border-radius: 3px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background-color: theme('colors.neutral.500');
  }
}

/* Dark mode overrides */
@media (prefers-color-scheme: dark) {
  :root {
    color-scheme: dark;
  }
  
  body {
    @apply bg-neutral-900 text-neutral-100;
  }
  
  .card {
    @apply bg-neutral-800 border-neutral-700;
  }
  
  .card-header {
    @apply border-neutral-700;
  }
  
  .card-footer {
    @apply border-neutral-700 bg-neutral-700;
  }
  
  .input {
    @apply bg-neutral-800 border-neutral-600 text-neutral-100 placeholder-neutral-400;
    @apply focus:border-primary-400 focus:ring-primary-200;
  }
  
  .input:disabled {
    @apply bg-neutral-700 text-neutral-400;
  }
  
  .btn-ghost {
    @apply text-neutral-300 hover:bg-neutral-800 active:bg-neutral-700;
  }
  
  .btn-secondary {
    @apply text-primary-400 border-primary-400 hover:bg-primary-900 active:bg-primary-800;
  }
  
  .macos-blur {
    background: rgba(30, 30, 30, 0.72);
  }
  
  .windows-mica {
    background: rgba(30, 30, 30, 0.78);
  }
  
  .modal-content {
    @apply bg-neutral-800;
  }
  
  .badge-primary {
    @apply bg-primary-900 text-primary-200;
  }
  
  .badge-secondary {
    @apply bg-secondary-900 text-secondary-200;
  }
  
  .badge-warning {
    @apply bg-warning-900 text-warning-200;
  }
  
  .badge-error {
    @apply bg-error-900 text-error-200;
  }
  
  .badge-neutral {
    @apply bg-neutral-700 text-neutral-200;
  }
  
  .audio-bar.idle {
    @apply bg-neutral-600;
  }
  
  .scrollbar-thin {
    scrollbar-color: theme('colors.neutral.600') transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: theme('colors.neutral.600');
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    background-color: theme('colors.neutral.500');
  }
}

/* Platform-specific adaptations */
.platform-macos .titlebar {
  height: 44px;
  padding-left: 80px; /* Space for traffic lights */
}

.platform-windows .titlebar {
  height: 32px;
  padding-left: 16px;
}

.platform-linux .titlebar {
  height: 32px;
  padding-left: 16px;
}

/* Text utilities */
.line-clamp-1 {
  display: -webkit-box;
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Accessibility utilities */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.skip-link {
  @apply sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4;
  @apply bg-primary-600 text-white px-4 py-2 rounded-md z-tooltip;
}